Практика 1

ВЫБРАТЬ
	2 * 3 + 4 КАК Поле1,
	"Строка1" + "Строка2" КАК Поле2,
	8 КАК Поле3,
	"8" КАК Поле4

Практика 2

ВЫБРАТЬ
	ПоступлениеТоваровТовары.Номенклатура КАК Номенклатура,
	МАКСИМУМ(ПоступлениеТоваровТовары.Цена) КАК Цена
ИЗ
	Документ.ПоступлениеТоваров.Товары КАК ПоступлениеТоваровТовары
ГДЕ
	ПоступлениеТоваровТовары.Номенклатура = &Номенклатура
	И ПоступлениеТоваровТовары.Ссылка.Проведен

СГРУППИРОВАТЬ ПО
	ПоступлениеТоваровТовары.Номенклатура

Практика 3

ВЫБРАТЬ
КОЛИЧЕСТВО(*)
ИЗ
РегистрНакопления.Закупки

Практика 4

ВЫБРАТЬ
	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ Закупки.Регистратор) КАК Регистратор
ИЗ
	РегистрНакопления.Закупки КАК Закупки

Практика 5

ВЫБРАТЬ ПЕРВЫЕ 3
	ПродажиОбороты.Контрагент КАК Контрагент,
	СУММА(ПродажиОбороты.СуммаОборот) КАК СуммаОборот
ИЗ
	РегистрНакопления.Продажи.Обороты КАК ПродажиОбороты

СГРУППИРОВАТЬ ПО
	ПродажиОбороты.Контрагент

УПОРЯДОЧИТЬ ПО
	СуммаОборот УБЫВ

Практика 6

ВЫБРАТЬ
	ПоступлениеТоваровТовары.Ссылка КАК Документ,
	ПоступлениеТоваровТовары.Номенклатура КАК Номенклатура,
	ПоступлениеТоваровТовары.Цена КАК Цена
ИЗ
	Документ.ПоступлениеТоваров.Товары КАК ПоступлениеТоваровТовары
ГДЕ
	ПоступлениеТоваровТовары.Цена > &Цена

Практика 7

ВЫБРАТЬ
	Номенклатура.Наименование КАК Наименование
ИЗ
	Справочник.Номенклатура КАК Номенклатура 
ГДЕ
	Номенклатура.Наименование ПОДОБНО "%\%%" СПЕЦСИМВОЛ "\"

Практика 8

ВЫБРАТЬ
	Контрагенты.Наименование КАК Наименование,
	Контрагенты.Телефон КАК Телефон
ИЗ
	Справочник.Контрагенты КАК Контрагенты
ГДЕ
	Контрагенты.Телефон НЕ ПОДОБНО "+7(___)___-__-__"

Практика 9

ВЫБРАТЬ РАЗЛИЧНЫЕ
	РеализацияТоваровТовары.Ссылка.Контрагент КАК Контрагент
ИЗ
	Документ.РеализацияТоваров.Товары КАК РеализацияТоваровТовары
ГДЕ
	РеализацияТоваровТовары.Номенклатура = &Номенклатура

Практика 10

ВЫБРАТЬ
	Контрагенты.Наименование КАК Наименование
ИЗ
	Справочник.Контрагенты КАК Контрагенты
ГДЕ
	Контрагенты.Город = &Город

Практика 11

ВЫБРАТЬ
	РасчетныеСчета.Наименование КАК Наименование,
	РасчетныеСчета.Владелец КАК Владелец,
	РасчетныеСчета.Банк КАК Банк
ИЗ
	Справочник.РасчетныеСчета КАК РасчетныеСчета
ГДЕ
	РасчетныеСчета.Банк = &Банк

Практика 12

ВЫБРАТЬ
	Номенклатура.Наименование КАК Наименование
ИЗ
	Справочник.Номенклатура КАК Номенклатура
ГДЕ
	Номенклатура.ВидНоменклатуры = &ВидНоменклатуры

Практика 13

ВЫБРАТЬ РАЗЛИЧНЫЕ
	ПоступлениеТоваров.Контрагент КАК Контрагент,
	НАЧАЛОПЕРИОДА(ПоступлениеТоваров.Дата, ДЕНЬ) КАК Дата
ИЗ
	Документ.ПоступлениеТоваров КАК ПоступлениеТоваров

Практика 14

ВЫБРАТЬ
	ПоступлениеТоваровТовары.Номенклатура КАК Номенклатура,
	СУММА(ПоступлениеТоваровТовары.Сумма) КАК Сумма
ИЗ
	Документ.ПоступлениеТоваров.Товары КАК ПоступлениеТоваровТовары

СГРУППИРОВАТЬ ПО
	ПоступлениеТоваровТовары.Номенклатура

ИМЕЮЩИЕ
	СУММА(ПоступлениеТоваровТовары.Сумма) > &Сумма

Практика 15

ВЫБРАТЬ
	ПоступлениеТоваров.Дата КАК Дата,
	ПоступлениеТоваров.Номер КАК Номер,
	ПоступлениеТоваров.Контрагент КАК Контрагент,
	ВЫБОР МЕСЯЦ(ПоступлениеТоваров.Дата)
		КОГДА 1
			ТОГДА "Январь"
		КОГДА 2
			ТОГДА "Февраль"
		КОГДА 3
			ТОГДА "Март"
		КОГДА 4
			ТОГДА "Апрель"
		КОГДА 5
			ТОГДА "Май"
		КОГДА 6
			ТОГДА "Июнь"
		КОГДА 7
			ТОГДА "Июль"
		КОГДА 8
			ТОГДА "Август"
		КОГДА 9
			ТОГДА "Сентябрь"
		КОГДА 10
			ТОГДА "Октябрь"
		КОГДА 11
			ТОГДА "Ноябрь"
		КОГДА 12
			ТОГДА "Декабрь"
	КОНЕЦ КАК Месяц
ИЗ
	Документ.ПоступлениеТоваров КАК ПоступлениеТоваров
ГДЕ
	ПоступлениеТоваров.Дата МЕЖДУ НАЧАЛОПЕРИОДА(&НачПериода, ДЕНЬ) И КОНЕЦПЕРИОДА(&КонПериода, ДЕНЬ)

Практика 16

&НаСервере
Процедура ПоказатьНаСервере(ТабДок)
	Макет = РеквизитФормыВЗначение("Объект").ПолучитьМакет("Макет");
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ПродажиОбороты.Период КАК Месяц,
	|	ПродажиОбороты.Контрагент КАК Контрагент,
	|	ПродажиОбороты.СуммаОборот КАК Сумма,
	|	ПРЕДСТАВЛЕНИЕ(ПродажиОбороты.Контрагент) КАК КонтрагентПредставление
	|ИЗ
	|	РегистрНакопления.Продажи.Обороты(, , Месяц, ) КАК ПродажиОбороты
	|
	|УПОРЯДОЧИТЬ ПО
	|	Месяц
	|ИТОГИ
	|	СУММА(Сумма)
	|ПО
	|	ОБЩИЕ,
	|	Контрагент,
	|	Месяц ПЕРИОДАМИ(МЕСЯЦ, , )";
	РезультатЗапроса = Запрос.Выполнить();
	
	ОбластьШапкаМесяц = Макет.ПолучитьОбласть("Шапка|Месяц");
	ОбластьШапкаКонтрагент = Макет.ПолучитьОбласть("Шапка|Контрагент");
	ОбластьШапкаИтог = Макет.ПолучитьОбласть("Шапка|Итог");
	ОбластьСтрокаМесяц = Макет.ПолучитьОбласть("Строка|Месяц");
	ОбластьСтрокаКонтрагент = Макет.ПолучитьОбласть("Строка|Контрагент");
	ОбластьСтрокаИтог = Макет.ПолучитьОбласть("Строка|Итог");
	ОбластьПодвалМесяц =  Макет.ПолучитьОбласть("Подвал|Месяц");
	ОбластьПодвалКонтрагент = Макет.ПолучитьОбласть("Подвал|Контрагент");
	ОбластьПодвалИтог = Макет.ПолучитьОбласть("Подвал|Итог");
	ТабДок.Вывести(ОбластьШапкаКонтрагент);
	ВыборкаШапкаМесяц = РезультатЗапроса.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам, "Месяц", "ВСЕ");
	Пока ВыборкаШапкаМесяц.Следующий() Цикл
		ОбластьШапкаМесяц.Параметры.Заполнить(ВыборкаШапкаМесяц);
		ТабДок.Присоединить(ОбластьШапкаМесяц);
	КОнецЦикла;
	ТабДок.Присоединить(ОбластьШапкаИтог);
	ВыборкаКонтрагент = РезультатЗапроса.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам, "Контрагент");
	Пока ВыборкаКонтрагент.Следующий() Цикл
		ОбластьСтрокаКонтрагент.Параметры.Заполнить(ВыборкаКонтрагент);
		ТабДок.Вывести(ОбластьСтрокаКонтрагент);
		ВыборкаМесяц = ВыборкаКонтрагент.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам, "Месяц", "ВСЕ");
		Пока ВыборкаМесяц.Следующий() Цикл
			ОбластьСтрокаМесяц.Параметры.Заполнить(ВыборкаМесяц);
			ТабДок.Присоединить(ОбластьСтрокаМесяц);
			
		КонецЦикла;
		ОбластьСтрокаИтог.Параметры.Заполнить(ВыборкаКонтрагент);
		ТабДок.Присоединить(ОбластьСтрокаИтог);
	КонецЦикла;
	
	ТабДок.Вывести(ОбластьПодвалКонтрагент);
	ВыборкаШапкаМесяц.Сбросить();
	Пока ВыборкаШапкаМесяц.Следующий() Цикл
		
		ОбластьПодвалМесяц.Параметры.Заполнить(ВыборкаШапкаМесяц);
		ТабДок.Присоединить(ОбластьПодвалМесяц);
	КонецЦикла;
	
	ВыборкаОбщийИтог = РезультатЗапроса.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	Если ВыборкаОбщийИтог.Следующий() Тогда
		ОбластьПодвалИтог.Параметры.Заполнить(ВыборкаОбщийИтог);
		ТабДок.Присоединить(ОбластьПодвалИтог);
	КонецЕсли;
КонецПроцедуры

&НаКлиенте
Процедура Показать(Команда)
	ТабДок = Новый ТабличныйДокумент;
	ПоказатьНаСервере(ТабДок);
	ТабДок.Показать();
КонецПроцедуры


Практика 17

Заголовок

ВЫБРАТЬ
	ТоварыНаСкладах.Регистратор КАК Регистратор,
	ТоварыНаСкладах.Регистратор.Дата КАК РегистраторДата
ИЗ
	РегистрНакопления.ТоварыНаСкладах КАК ТоварыНаСкладах

Описание (Не полностью)

ВЫБРАТЬ
	ВЫБОР ДЕНЬГОДА(КОНЕЦПЕРИОДА(&ДатаНачала, ГОД))
		КОГДА 366
			ТОГДА НАЧАЛОПЕРИОДА(&ДатаНачала, ГОД)
		ИНАЧЕ NULL
	КОНЕЦ КАК Поле1

Практика 18

ВЫБРАТЬ ПЕРВЫЕ 3
	ПродажиОбороты.Контрагент КАК Контрагент,
	СУММА(ПродажиОбороты.СуммаОборот) КАК СуммаОборот
ИЗ
	РегистрНакопления.Продажи.Обороты КАК ПродажиОбороты

СГРУППИРОВАТЬ ПО
	ПродажиОбороты.Контрагент

УПОРЯДОЧИТЬ ПО
	СуммаОборот УБЫВ


Процедура ОбработкаПолученияПолейПредставления(Поля, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;
	Поля.Добавить("Артикул");
	Поля.Добавить("Наименование");
КонецПроцедуры


Процедура ОбработкаПолученияПредставления(Данные, Представление, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;
	Представление = Данные.Артикул + " - " + Данные.Наименование;
КонецПроцедуры

Практика 19

ВЫБРАТЬ
	ПоступлениеТоваровТовары.Номенклатура КАК Номенклатура,
	ПоступлениеТоваровТовары.Количество КАК Количество,
	ПоступлениеТоваровТовары.Цена КАК Цена,
	ПоступлениеТоваровТовары.Сумма КАК Сумма
ИЗ
	Документ.ПоступлениеТоваров.Товары КАК ПоступлениеТоваровТовары
ИТОГИ
	СУММА(Количество),
	ВЫБОР
		КОГДА СУММА(ПоступлениеТоваровТовары.Количество) = 0
			ТОГДА 0
		ИНАЧЕ СУММА(ПоступлениеТоваровТовары.Сумма) / СУММА(ПоступлениеТоваровТовары.Количество)
	КОНЕЦ КАК Цена,
	СУММА(Сумма)
ПО
	Номенклатура

Практика 20

ВЫБРАТЬ
	Склады.Ссылка КАК Ссылка
ИЗ
	Справочник.Склады КАК Склады
ГДЕ
	НЕ Склады.Ссылка В
				(ВЫБРАТЬ
					ПоступлениеТоваров.Склад КАК Склад
				ИЗ
					Документ.ПоступлениеТоваров КАК ПоступлениеТоваров)

Практика 21

ВЫБРАТЬ
	КурсыВалют.Валюта КАК Валюта,
	МИНИМУМ(КурсыВалют.Курс) КАК КурсМин,
	МАКСИМУМ(КурсыВалют.Курс) КАК КурсМакс
ПОМЕСТИТЬ ВременнаяТаблица
ИЗ
	РегистрСведений.КурсыВалют КАК КурсыВалют

СГРУППИРОВАТЬ ПО
	КурсыВалют.Валюта
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	ВременнаяТаблица.Валюта КАК Валюта,
	КурсыВалютМакс.Период КАК Период,
	ВременнаяТаблица.КурсМакс КАК КурсМакс,
	КурсыВалютМакс.Период КАК Период1,
	ВременнаяТаблица.КурсМин КАК КурсМин
ИЗ
	ВременнаяТаблица КАК ВременнаяТаблица
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалют КАК КурсыВалютМакс
		ПО (ВременнаяТаблица.Валюта = КурсыВалютМакс.Валюта)
			И (КурсыВалютМакс.Курс = ВременнаяТаблица.КурсМакс)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалют КАК КурсыВалютМин
		ПО (КурсыВалютМин.Валюта = ВременнаяТаблица.Валюта)
			И (ВременнаяТаблица.КурсМин = КурсыВалютМин.Курс)

Практика 22

ВЫБРАТЬ
	КадроваяИсторияСрезПоследних.Сотрудник КАК Сотрудник,
	КадроваяИсторияСрезПоследних.Должность КАК Должность
ИЗ
	РегистрСведений.КадроваяИстория.СрезПоследних КАК КадроваяИсторияСрезПоследних
ГДЕ
	КадроваяИсторияСрезПоследних.Должность.Наименование ПОДОБНО "%" + &Должность + "%"

Практика 23

ВЫБРАТЬ
	КадроваяИсторияСрезПоследних.Сотрудник КАК Сотрудник,
	КадроваяИсторияСрезПоследних.Должность КАК Должность
ИЗ
	РегистрСведений.КадроваяИстория.СрезПоследних(, Должность.Наименование Подобно &Наименование) КАК КадроваяИсторияСрезПоследних

Практика 24

ВЫБРАТЬ
	ЦеныНоменклатурыСрезПоследнихЗакупочная.Номенклатура КАК Номенклатура,
	ЦеныНоменклатурыСрезПоследнихЗакупочная.Цена КАК ЦенаРозничная,
	0 КАК ЦенаЗакупочная
ПОМЕСТИТЬ ВременнаяТаблица
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(, ТипЦен = &ЦенаЗакупочная) КАК ЦеныНоменклатурыСрезПоследнихЗакупочная

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЦеныНоменклатурыСрезПоследнихРозничная.Номенклатура,
	0,
	ЦеныНоменклатурыСрезПоследнихРозничная.Цена
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(, ТипЦен = &ЦенаРозничная) КАК ЦеныНоменклатурыСрезПоследнихРозничная
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВременнаяТаблица.Номенклатура КАК Номенклатура,
	СУММА(ВременнаяТаблица.ЦенаРозничная) КАК ЦенаРозничная,
	СУММА(ВременнаяТаблица.ЦенаЗакупочная) КАК ЦенаЗакупочная,
	ВЫБОР СУММА(ВременнаяТаблица.ЦенаЗакупочная)
		КОГДА 0
			ТОГДА 0
		ИНАЧЕ СУММА(ВременнаяТаблица.ЦенаЗакупочная) / СУММА(ВременнаяТаблица.ЦенаРозничная) * 100 - 100
	КОНЕЦ КАК ПроцентНаценки
ИЗ
	ВременнаяТаблица КАК ВременнаяТаблица

СГРУППИРОВАТЬ ПО
	ВременнаяТаблица.Номенклатура

Практика 25
Сделал

Практика 26
Сделал

Практика 27

ВЫБРАТЬ
	ПродажиОбороты.Контрагент КАК Контрагент,
	ПродажиОбороты.СуммаОборот КАК Товары,
	0 КАК Услуги
ПОМЕСТИТЬ ВременнаяТаблица
ИЗ
	РегистрНакопления.Продажи.Обороты(, , , Номенклатура.ВидНоменклатуры = &ВидТовары) КАК ПродажиОбороты

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ПродажиОбороты.Контрагент,
	0,
	ПродажиОбороты.СуммаОборот
ИЗ
	РегистрНакопления.Продажи.Обороты(, , , Номенклатура.ВидНоменклатуры = &ВидУслуги) КАК ПродажиОбороты
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВременнаяТаблица.Контрагент КАК Контрагент,
	СУММА(ВременнаяТаблица.Товары) КАК Товары,
	СУММА(ВременнаяТаблица.Услуги) КАК Услуги
ИЗ
	ВременнаяТаблица КАК ВременнаяТаблица

СГРУППИРОВАТЬ ПО
	ВременнаяТаблица.Контрагент

Практика 28

Не получилось

Практика 29

ВЫБРАТЬ
	ПродажиОбороты.Номенклатура.ВидНоменклатуры КАК ВидНоменклатуры,
	СУММА(ПродажиОбороты.КоличествоОборот) КАК КоличествоОборот
ИЗ
	РегистрНакопления.Продажи.Обороты КАК ПродажиОбороты

СГРУППИРОВАТЬ ПО
	ПродажиОбороты.Номенклатура.ВидНоменклатуры

Практика 31
ВЫБРАТЬ
	0 КАК Поле1
ПОМЕСТИТЬ ВТ_Цифры

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	1

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	2

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	3

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	4

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	5

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	6

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	7

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	8

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	9
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(&Дата1, МЕСЯЦ), МЕСЯЦ, 100 * ВТ_Цифры0.Поле1 + 10 * ВТ_Цифры1.Поле1 + ВТ_Цифры2.Поле1) КАК Месяц
ИЗ
	ВТ_Цифры КАК ВТ_Цифры0
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_Цифры КАК ВТ_Цифры1
		ПО (ИСТИНА)
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_Цифры КАК ВТ_Цифры2
		ПО (ИСТИНА)
ГДЕ
	ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(&Дата1, МЕСЯЦ), МЕСЯЦ, 100 * ВТ_Цифры0.Поле1 + 10 * ВТ_Цифры1.Поле1 + ВТ_Цифры2.Поле1) МЕЖДУ &Дата1 И &Дата2

УПОРЯДОЧИТЬ ПО
	Месяц



ПРАКТИКА 32

ВЫБРАТЬ
	0 КАК Поле1
ПОМЕСТИТЬ ВТ_Цифры

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	1

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	2

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	3

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	4

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	5

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	6

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	7

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	8

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	9
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(&Дата1, ГОД), ГОД, 100 * ВТ_Цифры0.Поле1 + 10 * ВТ_Цифры1.Поле1 + ВТ_Цифры2.Поле1) КАК Месяц
ИЗ
	ВТ_Цифры КАК ВТ_Цифры0
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_Цифры КАК ВТ_Цифры1
		ПО (ИСТИНА)
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_Цифры КАК ВТ_Цифры2
		ПО (ИСТИНА)
ГДЕ
	ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(&Дата1, ГОД), ГОД, 100 * ВТ_Цифры0.Поле1 + 10 * ВТ_Цифры1.Поле1 + ВТ_Цифры2.Поле1) МЕЖДУ &Дата1 И &Дата2
	И ВЫБОР
			КОГДА 366 = ДЕНЬГОДА(КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(&Дата1, ГОД), ГОД, 100 * ВТ_Цифры0.Поле1 + 10 * ВТ_Цифры1.Поле1 + ВТ_Цифры2.Поле1), ГОД))
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ

УПОРЯДОЧИТЬ ПО
	Месяц


Практика 37

ВЫБРАТЬ
	ПродажиОбороты.Контрагент КАК Контрагент,
	ПродажиОбороты.СуммаОборот КАК СуммаОборот
ПОМЕСТИТЬ ВТ_База
ИЗ
	РегистрНакопления.Продажи.Обороты КАК ПродажиОбороты
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	&Сумма КАК Сумма
ПОМЕСТИТЬ ВТ_Парам
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	СУММА(ВТ_База.СуммаОборот) КАК ОбщаяСумма
ПОМЕСТИТЬ ВТ_ОбщаяСумма
ИЗ
	ВТ_База КАК ВТ_База
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_База.Контрагент КАК Контрагент,
	ВТ_База.СуммаОборот / ВТ_ОбщаяСумма.ОбщаяСумма * ВТ_Парам.Сумма КАК Процент
ПОМЕСТИТЬ ВТ_Промеж
ИЗ
	ВТ_База КАК ВТ_База,
	ВТ_ОбщаяСумма КАК ВТ_ОбщаяСумма,
	ВТ_Парам КАК ВТ_Парам
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Парам.Сумма КАК Сумма
ПОМЕСТИТЬ ВТ_Погрешность
ИЗ
	ВТ_Парам КАК ВТ_Парам

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	-ВТ_Промеж.Процент
ИЗ
	ВТ_Промеж КАК ВТ_Промеж
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	СУММА(ВТ_Погрешность.Сумма) КАК Сумма
ПОМЕСТИТЬ ВТ_Разница
ИЗ
	ВТ_Погрешность КАК ВТ_Погрешность
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Промеж.Контрагент КАК Контрагент,
	ВТ_Промеж.Процент КАК Процент
ПОМЕСТИТЬ ВТ
ИЗ
	ВТ_Промеж КАК ВТ_Промеж

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ ПЕРВЫЕ 1
	ВТ_Промеж.Контрагент,
	ВТ_Разница.Сумма
ИЗ
	ВТ_Промеж КАК ВТ_Промеж,
	ВТ_Разница КАК ВТ_Разница
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ.Контрагент КАК Контрагент,
	СУММА(ВТ.Процент) КАК Процент
ИЗ
	ВТ КАК ВТ

СГРУППИРОВАТЬ ПО
	ВТ.Контрагент
ИТОГИ
	СУММА(Процент)
ПО
	ОБЩИЕ

